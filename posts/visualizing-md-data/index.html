<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Visualizing MD Data | Journey to the Center of the Computer</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://markdewing.github.io/blog/posts/visualizing-md-data/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Mark Dewing">
<link rel="prev" href="../more-with-numba/" title="More Performance With Numba" type="text/html">
<link rel="next" href="../notes-on-cmake/" title="Notes on CMake" type="text/html">
<meta property="og:site_name" content="Journey to the Center of the Computer">
<meta property="og:title" content="Visualizing MD Data">
<meta property="og:url" content="https://markdewing.github.io/blog/posts/visualizing-md-data/">
<meta property="og:description" content="Visualizing atomic positions in 3D is useful when working on a molecular dynamics code.
More generally, being able to visualize the structures and algorithms inside a code can help with understanding
">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-12-08T22:14:00-06:00">
<meta property="article:tag" content="CoMD">
<meta property="article:tag" content="vispy">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Journey to the Center of the Computer</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.md" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Visualizing MD Data</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Mark Dewing
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2015-12-08T22:14:00-06:00" itemprop="datePublished" title="2015-12-08 22:14">2015-12-08 22:14</time></a>
            </p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/visualizing-md-data.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Visualizing atomic positions in 3D is useful when working on a molecular dynamics code.</p>
<p>More generally, being able to visualize the structures and algorithms inside a code can help with understanding
and debugging.
With all the advances in graphics hardware, it should be possible to quickly create visualizations for various
aspects of the code.
But this seems harder than it should be.
In this particular case, normal plotting packages can sometimes plot atomic positions with 3D scatter plots.
But then further algorithm visualization is hard (animation, drawing boxes, etc).</p>
<p>The <a href="http://vispy.org/VisPy">VisPy</a> project looks promising.
It contains three API levels </p>
<ol>
<li>
<code>gloo</code>- the lowest level API around OpenGL</li>
<li>
<code>scene</code>- uses a scene graph description</li>
<li>
<code>plot</code> - standard plotting interface</li>
</ol>
<p>The 'scene' interface is the appropriate abstraction level for our purposes.
Note this API is marked experimental and may change in the future.</p>
<h3>Pretty pictures</h3>
<p>Static screenshots (click for larger version)</p>
<p><a href="../../2015/md_screenshot2.png"><img alt="Screenshot2" src="../../2015/md_screenshot2_sm.png"></a>
<a href="../../2015/md_screenshot3.png"><img alt="Screenshot3" src="../../2015/md_screenshot3_sm.png"></a></p>
<p>And an animation (click for larger version)</p>
<p><a href="../../2015/animation.gif"><img alt="Screenshot3" src="../../2015/animation_sm.gif"></a></p>
<h3>Code</h3>
<p>The modified <code>comd.py</code> is <a href="https://gist.github.com/markdewing/28223759c2dbe24e1147">here</a>.
It should be a drop-in replacement for that file in the <a href="https://github.com/markdewing/multitevo/tree/master/CoMD/python/nsquared"><code>nsquared</code></a> version of the code.  The bulk of the visualization additions start around line 154.</p>
<p>The perceived speed of the simulation can vary.  Pure Python, even at the smallest system size, is too slow.
Using the <a href="http://markdewing.github.io/blog/posts/first-performance-improvements/">Numba-accelerated</a> loop makes it much faster.
However, for the smallest system, this feels 'too fast'.
Increasing the system size will slow it down (`-x 6 -y 6 -z 6' seems to work well on my system).
There are much better ways of adjusting the speed, but this is the most expedient.</p>
<p>The <code>-N</code> option specifies the number of steps (defaults to 100).  Set it to a larger value to run the animation longer.</p>
<p>During the run, press <code>s</code> to take a static screenshot (stored in <code>screenshot.png</code>).  Press 'a' key to start/stop saving
an animated segment (stored in <code>animation.gif</code>).   These features require that the <code>imageio</code> package is installed.</p>
<p>The <code>multiprocessing</code> package is used to run the simulation and the visualization event loop in separate processes.
Positions are passed from the simulation to the visualization via a Queue.
A Timer on the visualization side checks the queue for new positions periodically.</p>
<p>This code snippet uses the Marker visual element to display the center of each point.
This size is the size of the element on the screen, not the size in the scene (that is, elements don't change size when zooming)
The current size was chosen to easily see the motion of the atoms, not to accurately represent the atom's size.
Displaying a Sphere at each point would be more accurate, but is much slower.</p>
<h3>Summary</h3>
<p>I'm very pleased with VisPy.  It enabled live, interactive animation of atoms from a molecular dynamics code with
 a small amount code.
I expect extending this to visualize more complex algorithms and data structures should be be straightforward.</p>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/comd/" rel="tag">CoMD</a></li>
            <li><a class="tag p-category" href="../../categories/vispy/" rel="tag">vispy</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../more-with-numba/" rel="prev" title="More Performance With Numba">Previous post</a>
            </li>
            <li class="next">
                <a href="../notes-on-cmake/" rel="next" title="Notes on CMake">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="journeytothecenterofthecomputer",
            disqus_url="https://markdewing.github.io/blog/posts/visualizing-md-data/",
        disqus_title="Visualizing MD Data",
        disqus_identifier="cache/posts/visualizing-md-data.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="journeytothecenterofthecomputer";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2024         <a href="mailto:markdewing%20(at)%20gmail%20(dot)%20com">Mark Dewing</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
